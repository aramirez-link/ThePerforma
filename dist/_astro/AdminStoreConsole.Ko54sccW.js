import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as c}from"./index.CVf8TyFT.js";import{g as le,b as ie,s as O,L as ne,f as R,u as V,l as oe,a as ce,i as de,c as pe,d as ue,e as xe,h as me,j as T,k as he,r as ge}from"./storefront.DD1YA6uZ.js";import"./index.BtUICepX.js";const S={id:"",name:"",slug:"",description:"",product_type:"physical",status:"draft",base_price_cents:0,currency:"usd",cover_image:"",gallery:[]},P="the-performa-admin-nav",F="store-product-media",y="https://iahvjkodgrwatcpjdxna.supabase.co".trim().replace(/\/+$/,""),be=j=>{const x=String(j.cover_image||j.gallery?.[0]||"").trim();if(!x)return null;if(/^https?:\/\//i.test(x)||/^data:image\//i.test(x))return x;if(x.startsWith("/storage/")&&y)return`${y}${x}`;if(x.startsWith("storage/v1/object/public/")&&y)return`${y}/${x}`;if(y){const m=x.replace(new RegExp(`^${F}/`),"").replace(/^\/+/,"");if(m.includes("/"))return`${y}/storage/v1/object/public/${F}/${m}`}return null};function ye(){const[j,x]=c.useState(""),[m,l]=c.useState(""),[w,d]=c.useState(!1),[B,G]=c.useState(!0),[D,K]=c.useState(!1),[I,W]=c.useState(""),[s,q]=c.useState({products:[],variants:[],orders:[],orderItems:[],reviews:[]}),[a,p]=c.useState(S),[g,v]=c.useState(null),[b,k]=c.useState([]),[i,h]=c.useState({product_id:"",sku:"",title:"",price_cents:0,inventory_mode:"unlimited",inventory_count:0,digital_delivery_url:"",is_default:!1}),[N,A]=c.useState(""),[u,H]=c.useState({createProduct:!1,createVariant:!1,catalog:!1,reviews:!1}),f=async()=>{const e=await oe();if(!e.ok){l(e.error);return}q(e.data)};c.useEffect(()=>{const e=async()=>{const o=await ce();W(o?.email||"");const U=await de();K(U),typeof window<"u"&&(U?localStorage.setItem(P,"true"):localStorage.removeItem(P)),U&&await f(),G(!1)};e();const n=le()?.auth.onAuthStateChange(()=>{e()});return()=>n?.data.subscription.unsubscribe()},[]),c.useEffect(()=>{if(!m)return;const e=window.setTimeout(()=>l(""),3e3);return()=>window.clearTimeout(e)},[m]);const E=c.useMemo(()=>{const e=new Map;return s.products.forEach(r=>e.set(r.id,r)),e},[s.products]),L=s.variants.filter(e=>e.product_id===N),z=s.products.filter(e=>e.status==="active").length,Y=s.reviews.filter(e=>e.status==="pending").length,J=c.useMemo(()=>{const e=new Map;for(const r of s.orderItems){const n=e.get(r.order_id)||[];n.push(r),e.set(r.order_id,n)}return e},[s.orderItems]),M=c.useMemo(()=>s.variants.map(e=>{const r=ie(e);return{variant:e,stock:r,product:E.get(e.product_id)||null}}).filter(e=>e.variant.inventory_mode==="finite"&&(e.stock.outOfStock||e.stock.lowStock)).sort((e,r)=>(e.stock.remaining??9999)-(r.stock.remaining??9999)),[E,s.variants]),Q=async()=>{d(!0);const e=await pe(j);d(!1),l(e.ok?"Check your email for the magic link.":e.error)},X=async e=>{const r=await ue(e);r.ok||l(r.error)},$=async e=>{const r=[];for(const n of e){const o=await T(n);if(!o.ok)return{ok:!1,error:o.error};r.push(o.data.url)}return{ok:!0,urls:r}},Z=async()=>{if(!a.name||!a.slug){l("Name and slug are required.");return}d(!0);let e=a.cover_image||"",r=[...a.gallery];if(g){const o=await $([g]);if(!o.ok){d(!1),l(o.error);return}e=o.urls[0]||e}if(b.length){const o=await $(b);if(!o.ok){d(!1),l(o.error);return}r=Array.from(new Set([...r,...o.urls]))}!e&&r.length&&(e=r[0]);const n=await xe({id:a.id||void 0,name:a.name,slug:a.slug,description:a.description,product_type:a.product_type,status:a.status,base_price_cents:Number(a.base_price_cents||0),currency:a.currency,cover_image:e||null,gallery:r});if(d(!1),!n.ok){l(n.error);return}l(a.id?"Product updated.":"Product saved."),p(S),v(null),k([]),await f()},ee=e=>{p({id:e.id,name:e.name,slug:e.slug,description:e.description||"",product_type:e.product_type,status:e.status,base_price_cents:Number(e.base_price_cents||0),currency:e.currency||"usd",cover_image:e.cover_image||"",gallery:Array.isArray(e.gallery)?e.gallery:[]}),v(null),k([]),A(e.id),l(`Editing product: ${e.name}`)},te=async e=>{if(!window.confirm(`Delete product "${e.name}"? This also deletes related variants.`))return;d(!0);const n=await me(e.id);if(d(!1),!n.ok){l(n.error);return}l("Product deleted."),N===e.id&&A(""),a.id===e.id&&(p(S),v(null),k([])),await f()},re=async()=>{if(!g){l("Choose an image first.");return}d(!0);const e=await T(g);if(d(!1),!e.ok){l(e.error);return}p(r=>({...r,cover_image:e.data.url})),v(null),l("Image uploaded. Cover image URL set.")},se=async()=>{if(!b.length){l("Choose one or more gallery images first.");return}d(!0);const e=await $(b);if(!e.ok){d(!1),l(e.error);return}d(!1),p(r=>{const n=Array.from(new Set([...r.gallery,...e.urls]));return{...r,cover_image:r.cover_image||n[0]||"",gallery:n}}),k([]),l("Gallery images uploaded.")},ae=async()=>{if(!i.product_id||!i.sku||!i.title){l("Pick product + add SKU and title.");return}d(!0);const e=await he({product_id:i.product_id,sku:i.sku,title:i.title,price_cents:Number(i.price_cents||0),inventory_mode:i.inventory_mode,inventory_count:i.inventory_mode==="finite"?Number(i.inventory_count||0):null,digital_delivery_url:i.digital_delivery_url||null,is_default:i.is_default});if(d(!1),!e.ok){l(e.error);return}l("Variant saved."),h({product_id:i.product_id,sku:"",title:"",price_cents:0,inventory_mode:"unlimited",inventory_count:0,digital_delivery_url:"",is_default:!1}),await f()},_=async(e,r)=>{const n=r==="mark_shipped"&&window.prompt("Tracking number (optional):","")||"",o=await ge({orderId:e,action:r,trackingNumber:n||void 0});l(o.ok?`Order ${r.replace("_"," ")} complete.`:o.error),o.ok&&await f()},C=e=>{H(r=>({...r,[e]:!r[e]}))};return B?t.jsx("section",{className:"mx-auto w-full max-w-6xl px-4 pb-20 pt-8 sm:px-6",children:t.jsx("div",{className:"rounded-3xl border border-white/15 bg-black/45 p-6",children:t.jsx("p",{className:"text-sm text-white/70",children:"Loading admin console..."})})}):I?D?t.jsxs("section",{className:"mx-auto w-full max-w-6xl px-4 pb-20 pt-8 sm:px-6",children:[t.jsx("div",{className:"rounded-3xl border border-white/15 bg-black/45 p-6",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gold/80",children:"Store Admin"}),t.jsx("h1",{className:"mt-2 font-display text-3xl",children:"Commerce Control"}),t.jsx("p",{className:"mt-1 text-sm text-white/70",children:I})]}),t.jsx("button",{type:"button",onClick:async()=>{localStorage.removeItem(P),await O(),window.location.reload()},className:"min-h-11 rounded-full border border-white/30 px-5 py-2 text-xs uppercase tracking-[0.24em] text-white/80",children:"Sign out"})]})}),t.jsxs("div",{className:"mt-5 grid gap-4 lg:grid-cols-2",children:[t.jsxs("article",{className:"rounded-3xl border border-white/15 bg-black/35 p-5 lg:col-span-2",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:"Inventory Alerts"}),t.jsxs("p",{className:"mt-1 text-xs text-white/55",children:["Low stock threshold: ",ne]}),t.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:[M.slice(0,12).map(e=>t.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3",children:[t.jsx("p",{className:"text-sm text-white/90",children:e.product?.name||"Unknown product"}),t.jsxs("p",{className:"text-xs text-white/65",children:[e.variant.title," (",e.variant.sku,")"]}),t.jsx("p",{className:`mt-1 text-xs ${e.stock.outOfStock?"text-rose-300":"text-gold"}`,children:e.stock.outOfStock?"Out of stock":`Low stock: ${e.stock.remaining} left`})]},e.variant.id)),!M.length&&t.jsx("p",{className:"text-sm text-white/60",children:"No low-stock or out-of-stock alerts."})]})]}),t.jsxs("article",{className:"relative rounded-3xl border border-white/15 bg-black/35 p-5",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:a.id?"Edit Product":"Create Product"}),a.id&&t.jsx("button",{type:"button",onClick:()=>{p(S),v(null),k([])},className:"min-h-10 rounded-full border border-white/25 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:"Cancel Edit"})]}),t.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[s.products.length," products total | ",z," active"]}),t.jsxs("div",{className:`mt-3 grid gap-2 pr-1 ${u.createProduct?"max-h-none":"max-h-[12rem] overflow-hidden pb-14"}`,children:[t.jsx("input",{value:a.name,onChange:e=>p(r=>({...r,name:e.target.value})),placeholder:"Name",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("input",{value:a.slug,onChange:e=>p(r=>({...r,slug:e.target.value.toLowerCase().replace(/\s+/g,"-")})),placeholder:"slug",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("textarea",{value:a.description,onChange:e=>p(r=>({...r,description:e.target.value})),rows:3,placeholder:"Description",className:"rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[t.jsx("select",{value:a.product_type,onChange:e=>p(r=>({...r,product_type:e.target.value})),className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm",children:["physical","digital_tool","digital_download","subscription","bundle"].map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("select",{value:a.status,onChange:e=>p(r=>({...r,status:e.target.value})),className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm",children:["draft","active","archived"].map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[t.jsx("input",{type:"number",min:0,value:a.base_price_cents,onChange:e=>p(r=>({...r,base_price_cents:Number(e.target.value)})),placeholder:"Base price (cents)",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("input",{value:a.currency,onChange:e=>p(r=>({...r,currency:e.target.value})),placeholder:"Currency (usd)",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"})]}),t.jsx("input",{value:a.cover_image,onChange:e=>p(r=>({...r,cover_image:e.target.value})),placeholder:"Cover image URL",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsxs("div",{className:"rounded-xl border border-white/20 bg-black/30 p-3",children:[t.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-white/55",children:"Upload Cover Image"}),t.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp,image/gif,image/avif",onChange:e=>v(e.target.files?.[0]||null),className:"mt-2 block w-full text-xs text-white/75 file:mr-3 file:min-h-10 file:rounded-full file:border file:border-white/25 file:bg-black/35 file:px-4 file:py-2 file:text-[10px] file:uppercase file:tracking-[0.2em] file:text-white/85"}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[t.jsx("button",{type:"button",onClick:re,disabled:w||!g,className:"min-h-10 rounded-full border border-gold/45 px-4 py-2 text-[10px] uppercase tracking-[0.2em] text-gold disabled:opacity-50",children:"Upload Image"}),g&&t.jsxs("span",{className:"text-[11px] text-white/55",children:[g.name," (",(g.size/(1024*1024)).toFixed(2)," MB)"]})]})]}),t.jsxs("div",{className:"rounded-xl border border-white/20 bg-black/30 p-3",children:[t.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-white/55",children:"Upload Gallery Images"}),t.jsx("input",{type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp,image/gif,image/avif",onChange:e=>k(Array.from(e.target.files||[])),className:"mt-2 block w-full text-xs text-white/75 file:mr-3 file:min-h-10 file:rounded-full file:border file:border-white/25 file:bg-black/35 file:px-4 file:py-2 file:text-[10px] file:uppercase file:tracking-[0.2em] file:text-white/85"}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[t.jsx("button",{type:"button",onClick:se,disabled:w||!b.length,className:"min-h-10 rounded-full border border-gold/45 px-4 py-2 text-[10px] uppercase tracking-[0.2em] text-gold disabled:opacity-50",children:"Upload Gallery"}),b.length>0&&t.jsxs("span",{className:"text-[11px] text-white/55",children:[b.length," image(s) selected"]})]}),a.gallery.length>0&&t.jsx("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:a.gallery.map((e,r)=>t.jsxs("div",{className:"rounded-lg border border-white/15 bg-black/25 p-2",children:[t.jsx("img",{src:e,alt:"",className:"h-20 w-full rounded-md border border-white/10 object-cover"}),t.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[t.jsx("p",{className:"truncate text-[11px] text-white/60",children:e}),t.jsx("button",{type:"button",onClick:()=>p(n=>({...n,gallery:n.gallery.filter(o=>o!==e)})),className:"min-h-9 rounded-full border border-white/25 px-3 py-1 text-[10px] uppercase tracking-[0.18em] text-white/75",children:"Remove"})]})]},`${e}-${r}`))})]}),t.jsx("button",{type:"button",onClick:Z,disabled:w,className:"min-h-11 rounded-full bg-ember px-5 py-2 text-[11px] uppercase tracking-[0.22em] text-ink",children:a.id?"Update Product":"Save Product"})]}),t.jsx("button",{type:"button",onClick:()=>C("createProduct"),className:"absolute bottom-3 right-3 min-h-9 rounded-full border border-white/25 bg-black/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:u.createProduct?"Collapse":"Expand"})]}),t.jsxs("article",{className:"relative rounded-3xl border border-white/15 bg-black/35 p-5",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:"Create Variant"}),t.jsxs("p",{className:"mt-1 text-xs text-white/55",children:[s.variants.length," variants in catalog"]}),t.jsxs("div",{className:`mt-3 grid gap-2 pr-1 ${u.createVariant?"max-h-none":"max-h-[12rem] overflow-hidden pb-14"}`,children:[t.jsxs("select",{value:i.product_id,onChange:e=>h(r=>({...r,product_id:e.target.value})),className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Select product"}),s.products.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),t.jsx("input",{value:i.sku,onChange:e=>h(r=>({...r,sku:e.target.value})),placeholder:"SKU",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("input",{value:i.title,onChange:e=>h(r=>({...r,title:e.target.value})),placeholder:"Variant title",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("input",{type:"number",min:0,value:i.price_cents,onChange:e=>h(r=>({...r,price_cents:Number(e.target.value)})),placeholder:"Price (cents)",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsxs("select",{value:i.inventory_mode,onChange:e=>h(r=>({...r,inventory_mode:e.target.value})),className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm",children:[t.jsx("option",{value:"unlimited",children:"unlimited"}),t.jsx("option",{value:"finite",children:"finite"})]}),i.inventory_mode==="finite"&&t.jsx("input",{type:"number",min:0,value:i.inventory_count,onChange:e=>h(r=>({...r,inventory_count:Number(e.target.value)})),placeholder:"Inventory count",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("input",{value:i.digital_delivery_url,onChange:e=>h(r=>({...r,digital_delivery_url:e.target.value})),placeholder:"Private digital link (optional)",className:"min-h-11 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsxs("label",{className:"flex min-h-11 items-center gap-2 text-xs text-white/80",children:[t.jsx("input",{type:"checkbox",checked:i.is_default,onChange:e=>h(r=>({...r,is_default:e.target.checked}))}),"Default variant"]}),t.jsx("button",{type:"button",onClick:ae,disabled:w,className:"min-h-11 rounded-full border border-gold/45 px-5 py-2 text-[11px] uppercase tracking-[0.22em] text-gold",children:"Save Variant"})]}),t.jsx("button",{type:"button",onClick:()=>C("createVariant"),className:"absolute bottom-3 right-3 min-h-9 rounded-full border border-white/25 bg-black/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:u.createVariant?"Collapse":"Expand"})]})]}),t.jsxs("div",{className:"mt-5 grid gap-4 lg:grid-cols-2",children:[t.jsxs("article",{className:"relative rounded-3xl border border-white/15 bg-black/35 p-5",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:"Catalog"}),t.jsxs("p",{className:"mt-1 text-xs text-white/55",children:["Showing ",u.catalog?s.products.length:Math.min(s.products.length,6)," of ",s.products.length]}),t.jsxs("div",{className:`mt-3 space-y-2 pr-1 ${u.catalog?"max-h-none":"max-h-[12rem] overflow-hidden pb-14"}`,children:[(u.catalog?s.products:s.products.slice(0,6)).map(e=>{const r=be(e);return t.jsxs("div",{className:`w-full rounded-xl border px-3 py-2 text-left text-sm ${N===e.id?"border-gold/60 bg-gold/10":"border-white/15 bg-black/25"}`,children:[t.jsx("button",{type:"button",onClick:()=>A(e.id),className:"w-full text-left",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-12 w-12 shrink-0 overflow-hidden rounded-lg border border-white/15 bg-black/35",children:r?t.jsx("img",{src:r,alt:"",className:"h-full w-full object-cover"}):t.jsx("div",{className:"flex h-full w-full items-center justify-center text-[9px] uppercase tracking-[0.18em] text-white/45",children:"No Img"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"truncate",children:e.name}),t.jsxs("p",{className:"text-xs text-white/55",children:[e.status," | ",e.product_type," | ",R(e.base_price_cents,e.currency)]})]})]})}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>ee(e),className:"min-h-9 rounded-full border border-gold/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-gold",children:"Edit"}),t.jsx("button",{type:"button",onClick:()=>void te(e),className:"min-h-9 rounded-full border border-rose-400/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-rose-200",children:"Delete"})]})]},e.id)}),!u.catalog&&s.products.length>6&&t.jsxs("p",{className:"rounded-xl border border-white/10 bg-black/20 px-3 py-2 text-xs text-white/55",children:["Expand to manage ",s.products.length-6," more products."]})]}),!!N&&t.jsxs("div",{className:"mt-3 rounded-xl border border-white/10 bg-black/20 p-3",children:[t.jsxs("p",{className:"text-[10px] uppercase tracking-[0.2em] text-gold/80",children:["Variants for ",E.get(N)?.name]}),t.jsxs("ul",{className:"mt-2 space-y-2",children:[L.map(e=>t.jsxs("li",{className:"rounded-lg border border-white/10 p-2 text-xs text-white/75",children:[e.title," (",e.sku,") | ",R(e.price_cents)," | ",e.inventory_mode,e.inventory_mode==="finite"?`:${e.inventory_count??0}`:""]},e.id)),!L.length&&t.jsx("li",{className:"text-xs text-white/50",children:"No variants for this product."})]})]}),t.jsx("button",{type:"button",onClick:()=>C("catalog"),className:"absolute bottom-3 right-3 min-h-9 rounded-full border border-white/25 bg-black/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:u.catalog?"Collapse":"Expand"})]}),t.jsxs("article",{className:"relative rounded-3xl border border-white/15 bg-black/35 p-5",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:"Reviews Moderation"}),t.jsxs("p",{className:"mt-1 text-xs text-white/55",children:["Pending: ",Y," | Total: ",s.reviews.length]}),t.jsxs("div",{className:`mt-3 space-y-2 pr-1 ${u.reviews?"max-h-none":"max-h-[12rem] overflow-hidden pb-14"}`,children:[(u.reviews?s.reviews.slice(0,30):s.reviews.slice(0,4)).map(e=>t.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3",children:[t.jsxs("p",{className:"text-xs text-gold",children:[e.rating," / 5"]}),t.jsx("p",{className:"text-sm text-white/90",children:e.title}),t.jsx("p",{className:"mt-1 text-xs text-white/65",children:e.body}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsx("button",{type:"button",onClick:async()=>{const r=await V(e.id,"approved");l(r.ok?"Review approved.":r.error),r.ok&&await f()},className:"min-h-10 rounded-full border border-gold/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-gold",children:"Approve"}),t.jsx("button",{type:"button",onClick:async()=>{const r=await V(e.id,"rejected");l(r.ok?"Review rejected.":r.error),r.ok&&await f()},className:"min-h-10 rounded-full border border-white/35 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:"Reject"}),t.jsx("span",{className:"text-[11px] text-white/55",children:e.status})]})]},e.id)),!u.reviews&&s.reviews.length>4&&t.jsxs("p",{className:"rounded-xl border border-white/10 bg-black/20 px-3 py-2 text-xs text-white/55",children:["Expand to moderate ",s.reviews.length-4," more reviews."]}),!s.reviews.length&&t.jsx("p",{className:"text-sm text-white/60",children:"No reviews yet."})]}),t.jsx("button",{type:"button",onClick:()=>C("reviews"),className:"absolute bottom-3 right-3 min-h-9 rounded-full border border-white/25 bg-black/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:u.reviews?"Collapse":"Expand"})]})]}),t.jsxs("article",{className:"mt-5 rounded-3xl border border-white/15 bg-black/35 p-5",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.24em] text-white/55",children:"Orders"}),t.jsxs("div",{className:"mt-3 space-y-3",children:[s.orders.map(e=>t.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("p",{className:"text-sm text-white/90",children:["Order #",e.id," | ",e.status]}),t.jsx("p",{className:"text-sm text-gold",children:R(e.total_cents,e.currency)})]}),t.jsxs("p",{className:"text-xs text-white/55",children:[e.stripe_customer_email||"No email"," | ",new Date(e.created_at).toLocaleString()]}),t.jsx("ul",{className:"mt-2 space-y-1 text-xs text-white/70",children:(J.get(e.id)||[]).map(r=>t.jsxs("li",{children:[r.title," ",r.variant_title?`(${r.variant_title})`:""," x",r.quantity]},r.id))}),t.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[t.jsx("button",{type:"button",onClick:()=>_(e.id,"refund"),className:"min-h-10 rounded-full border border-gold/45 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-gold",children:"Refund"}),t.jsx("button",{type:"button",onClick:()=>_(e.id,"cancel"),className:"min-h-10 rounded-full border border-white/35 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>_(e.id,"mark_shipped"),className:"min-h-10 rounded-full border border-white/35 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:"Mark shipped"}),t.jsx("button",{type:"button",onClick:()=>_(e.id,"resend_download_link"),className:"min-h-10 rounded-full border border-white/35 px-3 py-1 text-[10px] uppercase tracking-[0.2em] text-white/75",children:"Resend link"})]})]},e.id)),!s.orders.length&&t.jsx("p",{className:"text-sm text-white/60",children:"No orders synced yet. Configure webhook and run a checkout."})]})]}),m&&t.jsx("p",{className:"mt-4 text-sm text-gold",children:m})]}):t.jsx("section",{className:"mx-auto w-full max-w-3xl px-4 pb-20 pt-8 sm:px-6",children:t.jsxs("div",{className:"rounded-3xl border border-white/15 bg-black/45 p-6",children:[t.jsxs("p",{className:"text-sm text-white/75",children:["Signed in as ",I,", but this account is not in `store_admins`."]}),t.jsx("button",{type:"button",onClick:async()=>{localStorage.removeItem(P),await O(),window.location.reload()},className:"mt-4 min-h-11 rounded-full border border-white/30 px-5 py-2 text-xs uppercase tracking-[0.24em] text-white/80",children:"Sign out"}),m&&t.jsx("p",{className:"mt-3 text-sm text-gold",children:m})]})}):t.jsx("section",{className:"mx-auto w-full max-w-3xl px-4 pb-20 pt-8 sm:px-6",children:t.jsxs("div",{className:"rounded-3xl border border-white/15 bg-black/45 p-6",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gold/80",children:"Store Admin"}),t.jsx("h1",{className:"mt-2 font-display text-3xl",children:"Sign In"}),t.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Use a magic link or federated login. Access is restricted to users in `store_admins`."}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t.jsx("input",{value:j,onChange:e=>x(e.target.value),placeholder:"admin@theperforma.com",className:"min-h-11 flex-1 rounded-xl border border-white/20 bg-black/35 px-3 py-2 text-sm"}),t.jsx("button",{type:"button",onClick:Q,disabled:w,className:"min-h-11 rounded-full bg-ember px-5 py-2 text-[11px] uppercase tracking-[0.22em] text-ink",children:w?"Sending...":"Magic Link"})]}),t.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["google","github","facebook","apple"].map(e=>t.jsx("button",{type:"button",onClick:()=>X(e),className:"min-h-11 rounded-full border border-white/30 px-4 py-2 text-[11px] uppercase tracking-[0.22em] text-white/80",children:e},e))}),m&&t.jsx("p",{className:"mt-3 text-sm text-gold",children:m})]})})}export{ye as default};
